create table route (
    id serial primary key,
    route_name text not null
);

create table station (
    id serial primary key,
    name text not null,
    route_id int not null,
    "index" int not null,
    show_style int not null default 1,

    constraint fk_station_route
        foreign key (route_id)
        references route(id)
        on delete cascade
);

create index idx_station_route_order
    on station (route_id, "index");



CREATE TABLE IF NOT EXISTS stop_time (
  id          BIGSERIAL PRIMARY KEY,
  trip_id     INTEGER  NOT NULL,
  station_id  INTEGER  NOT NULL,
  dep_time    INTEGER  NOT NULL,
  ari_time    INTEGER  NOT NULL,
  stop_type   INTEGER  NOT NULL DEFAULT 0,
  stop        INTEGER  NOT NULL
);

-- 典型的に使う索引（任意）
CREATE INDEX IF NOT EXISTS ix_stop_time_trip_id    ON stop_time(trip_id);
CREATE INDEX IF NOT EXISTS ix_stop_time_station_id ON stop_time(station_id);

-- 外部キー（任意）
ALTER TABLE stop_time
  ADD CONSTRAINT fk_stop_time_trip
    FOREIGN KEY (trip_id) REFERENCES trip(id) ON DELETE CASCADE;
--
ALTER TABLE stop_time
  ADD CONSTRAINT fk_stop_time_station
    FOREIGN KEY (station_id) REFERENCES station(id) ON DELETE RESTRICT;